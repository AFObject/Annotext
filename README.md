# Annotext - 文言文字词注释背诵幽默小程序

自用 / [Vercel](annotext.vercel.app) / [Website](anno.afobject.xyz)

![](https://p.ipic.vip/rfbfk3.png)

- [TODO] 注释嵌套时鼠标浮动仅显示外层的问题
- [TODO] 注释嵌套时源代码编辑崩溃的问题

---

## 基本功能

- 文言文原文的录入、删除、修改
- 文言文注释的录入、删除、修改
- 为注释打标签（四色 `GABC` + 重点标记 `U`，8 种状态可选），以及相应的筛选功能
- 随机测试
- 打印模式
- 美观的界面与深色模式
- 导入翻译，对照阅读学习

本地部署后以上内容可持久化保存，网页端暂时为静态、但可导出临时修改的数据。

未设置防呆，所有功能都必须在设计的范围内使用。

----

## 文言文录入

点击左边栏的 <img src="static/img/add-document.svg" alt="drawing" width="20"/>，按提示导入文本。

1. 直接复制原文：复制原文，按提示操作即可。会自动处理换行（转化为多个 `<p>` 标记的段落）、多余空格等。
2. 导入带有注释的原文：同上，按提示操作即可，但可在复制的文本内用中文全角 `【】` 括起原文字词，紧随其后带上 `（）` 内标记注释。

```
齐威王召即墨大夫，语之曰："自子之【居】（任官）即墨也，【毁言】（指责的话语）【日至】（每天传来）。然吾使人视即墨，田野【辟】（同“僻”，开垦），人民【给】（富裕），官无事，东方【以】（因而）宁；是子不【事】（此指拍马、奉承）吾左右以求助也。"封之万家。召阿大夫，语之曰："自子守阿，【誉言】（赞美的话语）日至。吾使人视阿，田野不辟，人民贫【馁】（饥饿）。昔日赵攻鄄，子不救；卫取薛陵，子不知；是子【厚币】（重金）事吾左右以求誉也！"是日，烹阿大夫及左右尝誉者。于是群臣耸惧，莫敢【饰诈】（弄虚作假），【务】（力求）尽其情，齐国大【治】（社会安定），强于天下。
```

导入的注释可以在小括号内指定注释类型，八种类型的二字符标签分别为 `gg,aa,bb,cc,gl,al,bl,cl`，格式如：`【尝】（al曾经）`。若无指定，导入的注释默认标记为 `yellow`（`bb`）类型。

导入的注释可以用类似 Markdown 的 `##` 标记小标题，会自动转码成 `<h3>` 标签。

----

## 注释的录入与编辑

1. 录入注释：在中间原文内选中对应字词，键盘上按下回车，输入注释内容、再按回车，即添加完毕。新添加的注释默认标记为 `red` 类型。
2. 编辑或删除注释：右侧注释栏内在对应注释处右键，选择“编辑”或“删除”，按提示操作。

注释允许嵌套，若用网页 GUI 编辑的话，先录入外层注释，才能录入内层注释。

----

## 源代码编辑

点击底部的 <img src="static/img/file-edit.svg" alt="drawing" width="20"/>，进入源码编辑，源码的格式同“文言文录入”中的 2。这一界面可以用于修改录入错误的原文或者修复损坏的文章内容。点击“确定”后完成修改。

此“源码”并非真正的数据保存格式，真实的数据如文末“数据导出”部分所示。也就是说，整个修改过程经过两次转码。

----

## 随机测试

点击底部的 <img src="static/img/list-check.svg" alt="drawing" width="20"/>，进入随机测试，测试范围为右侧边栏所有显示的注释（已筛选好）。将不重复地测试这些注释，直至所有注释测试完毕。可以在测试过程中显示答案后直接更改注释的标签。

![](https://p.ipic.vip/qzwzel.png)

----

## 翻译模式

在「文言文录入」处最后末尾添加 `<translation>内容</translation>` 以激活翻译模式。点击翻译按钮后，将与原文一句一句对照显示。

要求翻译内容**所有标点符号**与原文完全匹配，否则会错配或无法运行。

点击底部的 <img src="static/img/language-exchange.svg" alt="drawing" width="20"/> 进入翻译模式，在翻译模式下，同样支持使用选中 + 回车的方式编辑注释。

![](https://p.ipic.vip/ouunnc.png)

----

## 打印模式

a. 带原文：点击底部的 <img src="static/img/print.svg" alt="drawing" width="20"/>，进入打印模式，此时将隐去一切互动性 UI 控件，提高右侧边栏占比至 40%，同时提高中栏原文行距，使得 Ctrl/Command + P 调用浏览器对话框打印效果最佳。键盘上 ↑、↓ 键调整原文行距，←、→ 键调整注释行距。

刷新页面即可退出打印模式。

b. 不带原文：点击底部的 <img src="static/img/file-export.svg" alt="drawing" width="20"/>，将打开至一个仅含注释的富文本网页，内含带答案版、不带答案版。复制至 Word, Pages 等文本编辑器进一步修改。

----

## 视图

### 总览

- 右上角的 <img src="static/img/sidebar.svg" alt="drawing" width="20"/> <img src="static/img/sidebar-flip.svg" alt="drawing" width="20"/> 可切换是否显示左/右边栏。

### 中栏原文

- 鼠标在字词高亮处悬浮可查看解释。

### 右侧注释栏

- 字词解释内容默认不显示，在对应注释内容上点击以显示单个注释内容。
- 点击顶端的“注释”字样可以为全部注释切换显示/不显示。
- 点击单个注释后，标签选择器将自动展开，可修改对应注释的标签。
- 在顶端的筛选器中选择仅展示特定标签的注释。`G`、`A`、`B`、`C` 为 `或` 关系，与 `U` 为 `与` 关系。

----

## 数据导出

点击左上角第二个按钮可下载 `json` 格式的全部数据。数据格式如下：

```json
{
    "articles": [
        {

            "content": "<p>原文</p>",
            "title": "标题"
            "annotations": [
                {
                    "end": 22,
                    "explanation": "注释内容",
                    "start": 20,
                    "text": "对应字词",
                    "type": "red"
                },
            ],
            "translation": "翻译文本"
        },
    ]
}
```

另一种导出方式是在源代码编辑界面复制带有特殊格式，但具有更佳可读性的纯文本。